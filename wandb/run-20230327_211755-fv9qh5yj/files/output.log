step 0: train loss 10.9891, val loss 10.9905
iter 0: loss 10.9876, time 39863.17ms, mfu -100.00%
iter 10: loss 10.3835, time 760.21ms, mfu 22.14%
iter 20: loss 9.8270, time 760.73ms, mfu 22.14%
iter 30: loss 9.5926, time 760.37ms, mfu 22.14%
iter 40: loss 9.2695, time 761.25ms, mfu 22.14%
iter 50: loss 9.0569, time 761.06ms, mfu 22.14%
iter 60: loss 8.8784, time 761.05ms, mfu 22.13%
iter 70: loss 8.7786, time 760.39ms, mfu 22.13%
iter 80: loss 8.4642, time 761.92ms, mfu 22.13%
iter 90: loss 8.2450, time 760.82ms, mfu 22.13%
iter 100: loss 8.1522, time 760.98ms, mfu 22.13%
iter 110: loss 7.8750, time 760.21ms, mfu 22.13%
iter 120: loss 7.5872, time 760.80ms, mfu 22.13%
iter 130: loss 7.4921, time 761.30ms, mfu 22.13%
iter 140: loss 7.2579, time 761.08ms, mfu 22.13%
iter 150: loss 7.0637, time 760.08ms, mfu 22.13%
iter 160: loss 6.9874, time 760.33ms, mfu 22.13%
iter 170: loss 6.9944, time 760.46ms, mfu 22.13%
iter 180: loss 6.7611, time 761.46ms, mfu 22.13%
iter 190: loss 6.8025, time 761.76ms, mfu 22.12%
iter 200: loss 6.5502, time 761.08ms, mfu 22.12%
iter 210: loss 6.7895, time 760.42ms, mfu 22.12%
iter 220: loss 6.7050, time 760.54ms, mfu 22.13%
iter 230: loss 6.5884, time 761.42ms, mfu 22.12%
iter 240: loss 6.5133, time 761.00ms, mfu 22.12%
iter 250: loss 6.4845, time 761.33ms, mfu 22.12%
iter 260: loss 6.3701, time 760.78ms, mfu 22.12%
iter 270: loss 6.4978, time 761.13ms, mfu 22.12%
iter 280: loss 6.3957, time 761.80ms, mfu 22.12%
iter 290: loss 6.3264, time 760.60ms, mfu 22.12%
iter 300: loss 6.3658, time 761.69ms, mfu 22.12%
iter 310: loss 6.3355, time 760.89ms, mfu 22.12%
iter 320: loss 6.4501, time 761.52ms, mfu 22.12%
iter 330: loss 6.3192, time 761.42ms, mfu 22.12%
iter 340: loss 6.2509, time 761.15ms, mfu 22.12%
iter 350: loss 5.9572, time 760.90ms, mfu 22.12%
iter 360: loss 6.2066, time 760.82ms, mfu 22.12%
iter 370: loss 6.3201, time 760.31ms, mfu 22.12%
iter 380: loss 6.0558, time 761.79ms, mfu 22.12%
iter 390: loss 6.1851, time 761.02ms, mfu 22.12%
iter 400: loss 6.2305, time 760.99ms, mfu 22.12%
iter 410: loss 5.9848, time 761.20ms, mfu 22.12%
iter 420: loss 6.1519, time 760.44ms, mfu 22.12%
iter 430: loss 5.9327, time 760.86ms, mfu 22.12%
iter 440: loss 6.0859, time 761.79ms, mfu 22.12%
iter 450: loss 5.9680, time 761.18ms, mfu 22.12%
iter 460: loss 5.9400, time 761.88ms, mfu 22.11%
iter 470: loss 5.9817, time 761.47ms, mfu 22.11%
iter 480: loss 5.6357, time 760.77ms, mfu 22.11%
iter 490: loss 5.7709, time 761.67ms, mfu 22.11%
iter 500: loss 5.7745, time 761.29ms, mfu 22.11%
iter 510: loss 5.8718, time 760.39ms, mfu 22.12%
iter 520: loss 5.7883, time 760.68ms, mfu 22.12%
iter 530: loss 5.8847, time 761.72ms, mfu 22.11%
iter 540: loss 5.6163, time 761.54ms, mfu 22.11%
iter 550: loss 5.6290, time 761.11ms, mfu 22.11%
iter 560: loss 5.6335, time 761.04ms, mfu 22.11%
iter 570: loss 5.8544, time 761.39ms, mfu 22.11%
iter 580: loss 5.7650, time 761.17ms, mfu 22.11%
iter 590: loss 5.5915, time 760.90ms, mfu 22.11%
iter 600: loss 5.4227, time 760.83ms, mfu 22.12%
iter 610: loss 5.6038, time 761.54ms, mfu 22.11%
iter 620: loss 5.5626, time 760.76ms, mfu 22.12%
iter 630: loss 5.6612, time 760.83ms, mfu 22.12%
iter 640: loss 5.5836, time 761.32ms, mfu 22.12%
iter 650: loss 5.4842, time 760.61ms, mfu 22.12%
iter 660: loss 5.4950, time 761.30ms, mfu 22.12%
iter 670: loss 5.5419, time 761.59ms, mfu 22.11%
iter 680: loss 5.4177, time 760.82ms, mfu 22.12%
iter 690: loss 5.3485, time 761.60ms, mfu 22.11%
iter 700: loss 5.2968, time 762.02ms, mfu 22.11%
iter 710: loss 5.4594, time 760.90ms, mfu 22.11%
iter 720: loss 5.3392, time 760.87ms, mfu 22.11%
iter 730: loss 5.4356, time 760.98ms, mfu 22.11%
iter 740: loss 5.1763, time 761.26ms, mfu 22.11%
iter 750: loss 5.2656, time 760.75ms, mfu 22.12%
iter 760: loss 5.4147, time 763.13ms, mfu 22.11%
iter 770: loss 5.3334, time 760.67ms, mfu 22.11%
iter 780: loss 5.3091, time 763.47ms, mfu 22.10%
iter 790: loss 5.3018, time 760.66ms, mfu 22.11%
iter 800: loss 5.2560, time 761.61ms, mfu 22.11%
iter 810: loss 5.1337, time 760.70ms, mfu 22.11%
iter 820: loss 5.1631, time 762.11ms, mfu 22.11%
iter 830: loss 5.4276, time 760.65ms, mfu 22.11%
iter 840: loss 5.1431, time 761.63ms, mfu 22.11%
iter 850: loss 5.2126, time 761.07ms, mfu 22.11%
iter 860: loss 5.1387, time 761.45ms, mfu 22.11%
iter 870: loss 5.0860, time 761.38ms, mfu 22.11%
iter 880: loss 5.1265, time 761.60ms, mfu 22.11%
iter 890: loss 5.0828, time 761.92ms, mfu 22.11%
iter 900: loss 5.1085, time 761.32ms, mfu 22.11%
iter 910: loss 5.0529, time 761.03ms, mfu 22.11%
iter 920: loss 5.0693, time 761.68ms, mfu 22.11%
iter 930: loss 4.9570, time 761.52ms, mfu 22.11%
iter 940: loss 4.8521, time 760.20ms, mfu 22.11%
iter 950: loss 4.9565, time 761.50ms, mfu 22.11%
iter 960: loss 5.0638, time 761.08ms, mfu 22.11%
iter 970: loss 4.8669, time 760.52ms, mfu 22.11%
iter 980: loss 4.9916, time 761.58ms, mfu 22.11%
iter 990: loss 4.9389, time 761.01ms, mfu 22.11%
step 1000: train loss 4.8919, val loss 4.8969
saving checkpoint to /cto_studio/datastory/common/GPT2
iter 1000: loss 4.9582, time 40364.24ms, mfu 19.94%
iter 1010: loss 4.9210, time 760.82ms, mfu 20.16%
iter 1020: loss 4.8711, time 760.91ms, mfu 20.36%
iter 1030: loss 4.8808, time 761.01ms, mfu 20.53%
iter 1040: loss 4.8440, time 767.55ms, mfu 20.67%
iter 1050: loss 4.8295, time 761.58ms, mfu 20.82%
iter 1060: loss 4.7967, time 761.31ms, mfu 20.95%
iter 1070: loss 4.6929, time 761.37ms, mfu 21.06%
iter 1080: loss 4.6577, time 761.03ms, mfu 21.17%
iter 1090: loss 4.5992, time 761.36ms, mfu 21.26%
iter 1100: loss 4.7834, time 761.75ms, mfu 21.34%
iter 1110: loss 4.7022, time 760.79ms, mfu 21.42%
iter 1120: loss 4.6079, time 760.89ms, mfu 21.49%
iter 1130: loss 4.5979, time 760.71ms, mfu 21.56%
iter 1140: loss 4.7098, time 760.92ms, mfu 21.61%
iter 1150: loss 4.5325, time 761.23ms, mfu 21.66%
iter 1160: loss 4.6412, time 761.18ms, mfu 21.71%
iter 1170: loss 4.6742, time 760.78ms, mfu 21.75%
iter 1180: loss 4.6359, time 761.22ms, mfu 21.79%
iter 1190: loss 4.6279, time 761.22ms, mfu 21.82%
iter 1200: loss 4.5343, time 760.83ms, mfu 21.85%
iter 1210: loss 4.4005, time 761.04ms, mfu 21.88%
iter 1220: loss 4.5995, time 760.58ms, mfu 21.90%
iter 1230: loss 4.6039, time 761.31ms, mfu 21.92%
iter 1240: loss 4.4345, time 760.94ms, mfu 21.94%
iter 1250: loss 4.4559, time 760.68ms, mfu 21.96%
iter 1260: loss 4.5265, time 761.01ms, mfu 21.98%
iter 1270: loss 4.5242, time 761.43ms, mfu 21.99%
iter 1280: loss 4.4916, time 760.47ms, mfu 22.00%
iter 1290: loss 4.4174, time 760.96ms, mfu 22.02%
iter 1300: loss 4.6146, time 760.89ms, mfu 22.03%
iter 1310: loss 4.5893, time 761.05ms, mfu 22.04%
iter 1320: loss 4.3503, time 760.94ms, mfu 22.04%
iter 1330: loss 4.3509, time 760.41ms, mfu 22.05%
iter 1340: loss 4.3885, time 760.89ms, mfu 22.06%
iter 1350: loss 4.3745, time 760.84ms, mfu 22.07%
iter 1360: loss 4.5123, time 760.68ms, mfu 22.07%
iter 1370: loss 4.4155, time 760.79ms, mfu 22.08%
iter 1380: loss 4.4857, time 761.47ms, mfu 22.08%
iter 1390: loss 4.4051, time 760.73ms, mfu 22.09%
iter 1400: loss 4.3278, time 761.10ms, mfu 22.09%
iter 1410: loss 4.3449, time 761.95ms, mfu 22.09%
iter 1420: loss 4.2759, time 760.83ms, mfu 22.09%
iter 1430: loss 4.3769, time 760.76ms, mfu 22.10%
iter 1440: loss 4.3228, time 761.35ms, mfu 22.10%
iter 1450: loss 4.3709, time 760.74ms, mfu 22.10%
iter 1460: loss 4.3217, time 760.85ms, mfu 22.10%
iter 1470: loss 4.3591, time 761.41ms, mfu 22.10%
iter 1480: loss 4.3642, time 760.90ms, mfu 22.10%
iter 1490: loss 4.3151, time 761.13ms, mfu 22.11%
iter 1500: loss 4.3397, time 760.94ms, mfu 22.11%
iter 1510: loss 4.3308, time 760.65ms, mfu 22.11%
iter 1520: loss 4.4030, time 760.76ms, mfu 22.11%
iter 1530: loss 4.4630, time 760.87ms, mfu 22.11%
iter 1540: loss 4.2595, time 760.51ms, mfu 22.11%
iter 1550: loss 4.3109, time 763.05ms, mfu 22.11%
iter 1560: loss 4.3545, time 761.12ms, mfu 22.11%
iter 1570: loss 4.2449, time 762.83ms, mfu 22.10%
iter 1580: loss 4.1672, time 760.41ms, mfu 22.11%
iter 1590: loss 4.3217, time 761.10ms, mfu 22.11%
iter 1600: loss 4.2398, time 761.12ms, mfu 22.11%
iter 1610: loss 4.1308, time 760.83ms, mfu 22.11%
iter 1620: loss 4.2728, time 761.57ms, mfu 22.11%
iter 1630: loss 4.1883, time 761.71ms, mfu 22.11%
iter 1640: loss 4.2540, time 761.41ms, mfu 22.11%
iter 1650: loss 4.2835, time 760.77ms, mfu 22.11%
iter 1660: loss 4.2534, time 762.63ms, mfu 22.11%
iter 1670: loss 4.2101, time 761.18ms, mfu 22.11%
iter 1680: loss 4.1485, time 760.89ms, mfu 22.11%
iter 1690: loss 4.2451, time 761.89ms, mfu 22.11%
iter 1700: loss 4.2676, time 760.62ms, mfu 22.11%
iter 1710: loss 4.1543, time 761.49ms, mfu 22.11%
iter 1720: loss 4.1900, time 762.59ms, mfu 22.11%
iter 1730: loss 4.2222, time 760.77ms, mfu 22.11%
iter 1740: loss 4.2389, time 761.25ms, mfu 22.11%
iter 1750: loss 4.2260, time 761.34ms, mfu 22.11%
iter 1760: loss 4.2062, time 761.69ms, mfu 22.11%
iter 1770: loss 4.2545, time 761.67ms, mfu 22.11%
iter 1780: loss 4.1122, time 761.24ms, mfu 22.11%
iter 1790: loss 4.0857, time 761.53ms, mfu 22.11%
iter 1800: loss 4.3262, time 762.57ms, mfu 22.10%
iter 1810: loss 4.3705, time 760.91ms, mfu 22.10%
iter 1820: loss 4.1726, time 760.91ms, mfu 22.11%
iter 1830: loss 4.1553, time 761.58ms, mfu 22.11%
iter 1840: loss 4.0753, time 761.30ms, mfu 22.11%
iter 1850: loss 4.1624, time 761.02ms, mfu 22.11%
iter 1860: loss 4.0591, time 761.22ms, mfu 22.11%
iter 1870: loss 4.1920, time 761.07ms, mfu 22.11%
iter 1880: loss 3.9965, time 761.57ms, mfu 22.11%
iter 1890: loss 4.0406, time 761.27ms, mfu 22.11%
iter 1900: loss 4.0562, time 761.05ms, mfu 22.11%
iter 1910: loss 4.1176, time 760.84ms, mfu 22.11%
iter 1920: loss 4.0564, time 761.45ms, mfu 22.11%
iter 1930: loss 3.8932, time 761.98ms, mfu 22.11%
iter 1940: loss 4.0822, time 761.21ms, mfu 22.11%
iter 1950: loss 4.1199, time 761.06ms, mfu 22.11%
iter 1960: loss 4.0543, time 760.52ms, mfu 22.11%
iter 1970: loss 4.1903, time 761.52ms, mfu 22.11%
iter 1980: loss 4.1998, time 761.19ms, mfu 22.11%
iter 1990: loss 4.0422, time 762.99ms, mfu 22.11%
step 2000: train loss 4.0794, val loss 4.1046
saving checkpoint to /cto_studio/datastory/common/GPT2
iter 2000: loss 4.0450, time 40241.21ms, mfu 19.94%
iter 2010: loss 4.0756, time 761.30ms, mfu 20.15%
iter 2020: loss 4.1289, time 761.03ms, mfu 20.35%
iter 2030: loss 3.9121, time 761.39ms, mfu 20.53%
iter 2040: loss 4.1303, time 761.56ms, mfu 20.68%
iter 2050: loss 4.0975, time 761.82ms, mfu 20.83%
iter 2060: loss 4.0959, time 760.94ms, mfu 20.95%
iter 2070: loss 4.1490, time 761.39ms, mfu 21.07%
iter 2080: loss 4.0435, time 761.53ms, mfu 21.17%
iter 2090: loss 4.0424, time 761.31ms, mfu 21.27%
iter 2100: loss 4.0821, time 760.95ms, mfu 21.35%
iter 2110: loss 4.0323, time 761.06ms, mfu 21.43%
iter 2120: loss 3.9782, time 761.74ms, mfu 21.50%
iter 2130: loss 3.9035, time 761.20ms, mfu 21.56%
iter 2140: loss 3.9064, time 760.26ms, mfu 21.62%
iter 2150: loss 4.0811, time 761.68ms, mfu 21.66%
iter 2160: loss 4.1231, time 761.60ms, mfu 21.71%
iter 2170: loss 4.0053, time 761.00ms, mfu 21.75%
iter 2180: loss 4.1033, time 761.43ms, mfu 21.78%
iter 2190: loss 3.8299, time 761.47ms, mfu 21.82%
iter 2200: loss 3.9543, time 762.15ms, mfu 21.84%
iter 2210: loss 3.9060, time 761.36ms, mfu 21.87%
iter 2220: loss 3.9543, time 760.79ms, mfu 21.90%
iter 2230: loss 3.9146, time 760.73ms, mfu 21.92%
iter 2240: loss 3.8355, time 760.98ms, mfu 21.94%
iter 2250: loss 3.9043, time 761.62ms, mfu 21.95%
iter 2260: loss 3.9619, time 761.04ms, mfu 21.97%
iter 2270: loss 3.9338, time 760.37ms, mfu 21.99%
iter 2280: loss 3.8406, time 760.75ms, mfu 22.00%
iter 2290: loss 4.0651, time 760.84ms, mfu 22.01%
iter 2300: loss 4.1256, time 761.18ms, mfu 22.02%
iter 2310: loss 4.0790, time 761.20ms, mfu 22.03%
iter 2320: loss 4.0783, time 761.62ms, mfu 22.04%
iter 2330: loss 4.0463, time 760.31ms, mfu 22.05%
iter 2340: loss 3.9708, time 761.39ms, mfu 22.06%
iter 2350: loss 4.0804, time 761.41ms, mfu 22.06%
iter 2360: loss 4.1200, time 762.17ms, mfu 22.06%
iter 2370: loss 3.9218, time 761.42ms, mfu 22.07%
iter 2380: loss 3.8983, time 761.03ms, mfu 22.07%
iter 2390: loss 3.8982, time 760.76ms, mfu 22.08%
iter 2400: loss 3.8851, time 761.33ms, mfu 22.08%
iter 2410: loss 4.0681, time 760.62ms, mfu 22.09%
iter 2420: loss 3.9596, time 760.69ms, mfu 22.09%
iter 2430: loss 3.9062, time 760.15ms, mfu 22.10%
iter 2440: loss 3.8390, time 760.96ms, mfu 22.10%
iter 2450: loss 3.9437, time 760.85ms, mfu 22.10%
iter 2460: loss 3.9291, time 762.42ms, mfu 22.10%
iter 2470: loss 4.0234, time 761.11ms, mfu 22.10%
iter 2480: loss 3.8119, time 761.97ms, mfu 22.10%
iter 2490: loss 3.8732, time 760.99ms, mfu 22.10%
iter 2500: loss 3.9107, time 761.19ms, mfu 22.10%
iter 2510: loss 4.0197, time 761.45ms, mfu 22.10%
iter 2520: loss 4.0701, time 760.82ms, mfu 22.10%
iter 2530: loss 3.7712, time 760.84ms, mfu 22.11%
iter 2540: loss 3.7232, time 761.46ms, mfu 22.11%
iter 2550: loss 3.9272, time 760.95ms, mfu 22.11%
iter 2560: loss 3.8717, time 763.17ms, mfu 22.10%
iter 2570: loss 4.0163, time 760.93ms, mfu 22.10%
iter 2580: loss 3.8902, time 761.49ms, mfu 22.10%
iter 2590: loss 3.8150, time 761.13ms, mfu 22.11%
iter 2600: loss 3.8847, time 760.02ms, mfu 22.11%
iter 2610: loss 3.9054, time 760.83ms, mfu 22.11%
iter 2620: loss 3.8939, time 760.87ms, mfu 22.11%
iter 2630: loss 3.9590, time 761.42ms, mfu 22.11%
iter 2640: loss 3.8041, time 761.15ms, mfu 22.11%
iter 2650: loss 3.6871, time 760.93ms, mfu 22.11%
iter 2660: loss 3.8252, time 761.00ms, mfu 22.11%
iter 2670: loss 3.9078, time 761.10ms, mfu 22.11%
iter 2680: loss 3.8816, time 761.54ms, mfu 22.11%
iter 2690: loss 3.7985, time 760.22ms, mfu 22.12%
iter 2700: loss 3.8633, time 762.19ms, mfu 22.11%
iter 2710: loss 3.8842, time 761.14ms, mfu 22.11%
iter 2720: loss 3.8806, time 760.59ms, mfu 22.11%
iter 2730: loss 3.9104, time 761.15ms, mfu 22.11%
iter 2740: loss 3.8777, time 760.50ms, mfu 22.12%
iter 2750: loss 3.7037, time 761.04ms, mfu 22.12%
iter 2760: loss 3.9415, time 761.03ms, mfu 22.12%
iter 2770: loss 3.9505, time 763.91ms, mfu 22.11%
iter 2780: loss 3.9090, time 760.95ms, mfu 22.11%
iter 2790: loss 3.7733, time 761.25ms, mfu 22.11%
iter 2800: loss 3.7470, time 760.48ms, mfu 22.11%
iter 2810: loss 3.8431, time 761.22ms, mfu 22.11%
iter 2820: loss 3.8139, time 761.71ms, mfu 22.11%
iter 2830: loss 3.8597, time 760.91ms, mfu 22.11%
iter 2840: loss 3.7361, time 760.88ms, mfu 22.11%
iter 2850: loss 3.8239, time 761.63ms, mfu 22.11%
iter 2860: loss 3.8045, time 761.08ms, mfu 22.11%
iter 2870: loss 3.8402, time 760.92ms, mfu 22.11%
iter 2880: loss 3.8350, time 760.39ms, mfu 22.12%
iter 2890: loss 3.8230, time 761.86ms, mfu 22.11%
iter 2900: loss 3.9157, time 760.84ms, mfu 22.11%
iter 2910: loss 3.8010, time 761.06ms, mfu 22.11%
iter 2920: loss 3.9155, time 760.40ms, mfu 22.12%
Traceback (most recent call last):
  File "/home/linzihao/PreTrain/PreTrain/train.py", line 298, in <module>
    scaler.scale(loss).backward()
  File "/home/linzihao/anaconda3/envs/transformer/lib/python3.11/site-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/home/linzihao/anaconda3/envs/transformer/lib/python3.11/site-packages/torch/autograd/__init__.py", line 200, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt